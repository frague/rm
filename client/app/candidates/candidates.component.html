<div>
  <div class="alert alert-info message" *ngIf="message">{{ message }}</div>
  <h1>Requisitions &amp; candidates</h1>

  <comments-modal></comments-modal>

  <candidate-modal></candidate-modal>

  <requisition-modal></requisition-modal>

  <div class="requisitions" *ngIf="getRequisitions().length">
    <ng-container *ngFor="let category of getCategories()">
      <h3 *ngIf="isCategoryFilled[category]">{{ category }}</h3>
      <ng-container *ngFor="let requisition of requisitionCategories[category]">
        <div class="requisition row" *ngIf="requisitionCandidates[requisition.requisitionId] && requisitionCandidates[requisition.requisitionId].length" [ngClass]="isRequisitionSelected(requisition) && 'selected'">
          <div class="col-md-2">
            <i class="fa" [ngClass]="getRequisitionClass(requisition)" (click)="toggleSelection(requisition)"></i>
            <a (click)="showRequisition(requisition, $event)">{{ requisition.requisitionId }}</a>
            <span>
              {{ requisitionCandidates[requisition.requisitionId].length }}
              <i class="fa fa-male"></i>
            </span>
          </div>
          <div class="col-md-4" (click)="toggleSelection(requisition)">
            <i class="fa" [ngClass]="getStateClass(requisition.jobState)"></i>
            {{ requisition.title }}
          </div>
          <div class="col-md-1">
            {{ requisition.jobState }}
          </div>
          <div class="col-md-2">
            {{ requisition.department }}
          </div>
          <div class="col-md-3">
            <a [href]="getJvRequisitionLink(requisition)" target="_blank"><i class="fa fa-external-link-square"></i></a>
            {{ requisition.location }}
          </div>
        </div>
        <div class="candidates" *ngIf="isRequisitionSelected(requisition)">
          <div
            *ngFor="let candidate of requisitionCandidates[requisition.requisitionId]"
            class="row"
          >
            <div class="col-md-2">
              <div
                class="corner"
                (click)="showModal(candidate, $event, 'comments')"
                [ngClass]="{'has-status': candidate.status}"
                container="body"
                placement="top-left"
                [ngbTooltip]="getCurrentStatus(candidate)"
              >
                <b>{{ candidate.commentsCount || '' }}</b>
              </div>
              <a (click)="showModal(candidate, $event)">{{ candidate.name }}</a>
            </div>
            <div class="col-md-3">
              {{ candidate.state|cutIndex }}
            </div>
            <div class="col-md-2">
              {{ candidate.updated|date }}
            </div>
            <div class="col-md-5">
              <a [href]="getJvCandidateLink(candidate)" target="_blank"><i class="fa fa-external-link-square"></i></a>
              {{ candidate.location }}
            </div>
          </div>
        </div>
      </ng-container>
    </ng-container>
  </div>
</div>