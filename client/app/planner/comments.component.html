<ng-template #content let-c="close" let-d="dismiss">
  <div class="modal-header">
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
    <h4 class="modal-title">Notes about {{ person.name }}</h4>
  </div>
  <div class="comments-modal modal-body">
    <ngb-tabset (tabChange)="tabChange($event)" #tabs="ngbTabset">
      <ngb-tab title="All Notes" id="comments">
        <ng-template ngbTabContent>
          <div class="comments">
            <div
              *ngFor="let comment of aggregated"
              [ngClass]="{status: comment.isStatus}"
            >
              <div class="date">
                {{ comment.date|date }}
                <span>
                  <a (click)="delete(comment)"><i class="fa fa-trash"></i></a>
                  <a (click)="startEditing(comment, tabs)"><i class="fa fa-pencil"></i></a>
                </span>
              </div>
              <h6 *ngIf="comment.source">{{ comment.source }}</h6>
              <div [innerHTML]="comment.text|MarkdownToHtml"></div>
            </div>
          </div>
          <div class="empty" *ngIf="!aggregated.length">No comments added yet</div>
        </ng-template>
      </ngb-tab>
      <ngb-tab title="Add" id="add">
        <ng-template ngbTabContent>
          <div class="comment">
            <div class="row">
              <div class="col-md-8">
                <form class="form" [formGroup]="form">
                  <div class="form-group">
                    <input class="form-control" type="text" name="source" formControlName="source" placeholder="Source">
                  </div>
                  <div class="form-group">
                    <textarea class="form-control" name="text" formControlName="text" placeholder="Comment" required rows="7"></textarea>
                  </div>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input" type="checkbox" formControlName="isStatus">
                      This should be considered as a current status
                    </label>
                  </div>
                </form>
              </div>
              <div class="col-md-4">
                Preview:
                <div class="preview" [innerHTML]="form.value.text|MarkdownToHtml"></div>
              </div>
            </div>
          </div>
        </ng-template>
      </ngb-tab>
      <ngb-tab title="Skills" id="skills">
        <ng-template ngbTabContent>
          <div class="skills">
            <ul class="categories" *ngIf="skills && skills.categories">
              <li *ngFor="let category of skills.categories">
                <h2>{{ category.name }}</h2>
                <ul *ngIf="category.categories">
                  <li *ngFor="let sub of category.categories">
                    <h3>{{ sub.name }}</h3>
                    <skillset [skills]="sub.skills" *ngIf="sub.skills"></skillset>
                  </li>
                </ul>
                <skillset [skills]="category.skills" *ngIf="category.skills"></skillset>
              </li>
            </ul>
          </div>
        </ng-template>
      </ngb-tab>
    </ngb-tabset>
  </div>
  <div class="modal-footer" *ngIf="isFormActive">
    <button
      class="btn btn-primary pull-left"
      [disabled]="!form.valid || !hasChanges()"
      (click)="saveComplex(tabs)"
    ><i class="fa fa-floppy-o"></i> Save</button>
    <div class="form-check">
      <label class="form-check-label">
        <input class="form-check-input" type="checkbox" [(ngModel)]="closeAfterSaving">
        Close after saving
      </label>
    </div>
  </div>
</ng-template>